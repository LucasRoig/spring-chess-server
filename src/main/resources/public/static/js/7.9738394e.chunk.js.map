{"version":3,"sources":["database/DbDetails.js","database/DatabaseService.js","database/DatabaseDetails.js","models/Constants.js","models/Position.js","models/Game.js"],"names":["__webpack_require__","d","__webpack_exports__","GameHeader","DbDetails","tcomb__WEBPACK_IMPORTED_MODULE_0__","tcomb__WEBPACK_IMPORTED_MODULE_0___default","n","t","struct","whiteName","String","blackName","id","Number","name","gameHeaders","list","_services_ApiService__WEBPACK_IMPORTED_MODULE_0__","tcomb__WEBPACK_IMPORTED_MODULE_1__","tcomb__WEBPACK_IMPORTED_MODULE_1___default","_models_Game__WEBPACK_IMPORTED_MODULE_2__","_DbDetails__WEBPACK_IMPORTED_MODULE_3__","PostDatabaseRequest","listDatabases","ApiService","get","then","res","status","data","console","log","catch","e","error","postDatabase","_ref","request","post","getDetails","createGame","databaseId","game","Game","deleteDatabase","delete","importPgn","file","formData","FormData","append","GameDetails","props","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","onClick","className","stopPropagation","history","push","DatabaseDetails","_this","Object","C_Users_Lucas_Documents_dev_chess_ui_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","C_Users_Lucas_Documents_dev_chess_ui_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","C_Users_Lucas_Documents_dev_chess_ui_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","DatabaseService","state","database","db","setState","update","$push","onFileChanged","selectedPgn","target","files","uploadPgn","_this2","match","params","_this3","Fragment","type","onChange","map","key","Component","WHITE","BLACK","Position","fen","lastMove","previousPosition","nextPosition","comment","sublines","color","moveNumber","Constants","find","pos","_default","positions","startingPosition"],"mappings":"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","file":"static/js/7.9738394e.chunk.js","sourcesContent":["import t from \"tcomb\";\r\n\r\nexport const GameHeader = t.struct({\r\n  whiteName: t.String,\r\n  blackName: t.String,\r\n  id: t.Number\r\n})\r\nexport const DbDetails = t.struct({\r\n  name: t.String,\r\n  id: t.Number,\r\n  gameHeaders: t.list(GameHeader)\r\n})\r\n","import ApiService from \"../services/ApiService\";\r\nimport t from \"tcomb\";\r\nimport Game from \"../models/Game\";\r\nimport {DbDetails, GameHeader} from \"./DbDetails\";\r\n\r\nconst listDatabases = () => {\r\n  return ApiService.get(\"/database\").then(res => {\r\n    if (res.status === 200) {\r\n      return res.data;\r\n    } else {\r\n      throw res;\r\n    }\r\n  }).then(data => {\r\n    console.log(data)\r\n    return data\r\n  }).catch(e => {\r\n    console.error(e);\r\n    //TODO\r\n  })\r\n}\r\n\r\nconst PostDatabaseRequest = t.struct({\r\n  name: t.String,\r\n}, \"PostDatabaseRequest\")\r\n\r\nconst postDatabase = ({name}) => {\r\n  let request = PostDatabaseRequest({name});\r\n  return ApiService.post(\"/database\", request).then(res => {\r\n    if (res.status === 200 || res.status === 201) {\r\n      console.log(res.data)\r\n      return res.data\r\n    } else {\r\n      throw res;\r\n    }\r\n  }).catch(e => {\r\n    console.error(e);\r\n    //TODO\r\n  })\r\n}\r\n\r\nconst getDetails = (id) => {\r\n  return ApiService.get(\"/database/\" + id).then(res => {\r\n    if (res.status === 200) {\r\n      let d = DbDetails(res.data)\r\n      console.log(d)\r\n      return d;\r\n    } else {\r\n      throw res\r\n    }\r\n  }).catch(e => {\r\n    console.error(e);\r\n    //TODO\r\n  })\r\n}\r\n\r\nconst createGame = (databaseId) => {\r\n  let game = new Game();\r\n  return ApiService.post(\"/database/\" + databaseId + \"/game\", game).then(res => {\r\n    if (res.status === 200 || res.status === 201) {\r\n      let gameHeader = GameHeader({\r\n        whiteName: res.data.whiteName,\r\n        blackName: res.data.blackName,\r\n        id: res.data.id\r\n      })\r\n      return gameHeader;\r\n    } else {\r\n      throw res;\r\n    }\r\n  }).catch(e => {\r\n    console.error(e);\r\n    //TODO\r\n  })\r\n}\r\n\r\nconst deleteDatabase = (databaseId) => {\r\n  return ApiService.delete(\"/database/\" + databaseId).then(res => {\r\n    if (res.status === 200) {\r\n      return true;\r\n    } else {\r\n      throw res;\r\n    }\r\n  }).catch(e => {\r\n    console.error(e);\r\n    //TODO\r\n  });\r\n}\r\n\r\nconst importPgn = (databaseId, file) => {\r\n  const formData = new FormData();\r\n  formData.append(\"pgnFile\", file, file.name);\r\n  return ApiService.post(\"/database/\" + databaseId + \"/uploadPgn\", formData).then(res => {\r\n    if (res.status !== 200 && res.status !== 201) {\r\n      throw res;\r\n    } else {\r\n      return res.data;\r\n    }\r\n  });\r\n}\r\n\r\nexport default {\r\n  listDatabases,\r\n  postDatabase,\r\n  getDetails,\r\n  createGame,\r\n  deleteDatabase,\r\n  importPgn\r\n}\r\n","import React, {Component} from 'react';\r\nimport './DatabaseList.scss';\r\nimport DatabaseService from \"./DatabaseService\";\r\nimport {DbDetails} from \"./DbDetails\";\r\n\r\nconst GameDetails = (props) => {\r\n  function handleTraining(e) {\r\n    e.stopPropagation();\r\n    props.history.push(\"/training/\" + props.game.id);\r\n  }\r\n  function handleDelete(e) {\r\n    e.stopPropagation();\r\n  }\r\n  return (\r\n    <tr onClick={props.onClick}>\r\n      <td>{props.game.whiteName}</td>\r\n      <td>{props.game.blackName}</td>\r\n      <td></td>\r\n      <td>\r\n        <button className=\"button\" onClick={handleTraining}>Training</button>\r\n        <button className=\"button is-danger\" onClick={handleDelete}>Supprimer</button>\r\n      </td>\r\n    </tr>\r\n  )\r\n}\r\n\r\nclass DatabaseDetails extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      database: null,\r\n      selectedPgn: null\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    DatabaseService.getDetails(this.props.match.params.id).then(database => {\r\n      console.log(database)\r\n      this.setState({database})\r\n    })\r\n  }\r\n\r\n  createGame = () => {\r\n    DatabaseService.createGame(this.state.database.id).then(game => {\r\n      let db = this.state.database;\r\n      this.setState({\r\n        database: DbDetails.update(db, {gameHeaders: {$push: [game]}})\r\n      })\r\n    });\r\n  }\r\n\r\n  onFileChanged = (e) => {\r\n    this.setState({selectedPgn: e.target.files[0]})\r\n  }\r\n\r\n  uploadPgn = () => {\r\n    const selectedPgn = this.state.selectedPgn;\r\n    if (selectedPgn) {\r\n      DatabaseService.importPgn(this.state.database.id, selectedPgn);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        {this.state.database ?\r\n          <>\r\n            <h1 className=\"title is-1\">{this.state.database.name}</h1>\r\n            <div>\r\n              <button className=\"button\" onClick={this.createGame}>Add new Game</button>\r\n            </div>\r\n            <div>\r\n              <input type=\"file\" onChange={this.onFileChanged}/>\r\n              <button className=\"button\" onClick={this.uploadPgn}>Importer</button>\r\n            </div>\r\n            <table className=\"databases table is-striped is-hoverable is-fullwidth\">\r\n              <thead>\r\n              <tr>\r\n                <th>White</th>\r\n                <th>Black</th>\r\n                <th></th>\r\n                <th></th>\r\n              </tr>\r\n              </thead>\r\n              <tbody>\r\n              {this.state.database.gameHeaders.map(game =>\r\n                <GameDetails key={game.id} game={game}\r\n                             onClick={() => this.props.history.push(\"/game/\" + game.id)} history={this.props.history}/>)\r\n              }\r\n              </tbody>\r\n            </table>\r\n          </>\r\n          : <div>Loading</div>}\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default DatabaseDetails;\r\n","export let WHITE = \"w\";\r\nexport let BLACK = \"b\";","import * as Constants from './Constants';\r\nexport default class Position{\r\n    constructor(fen, lastMove, previousPosition){\r\n        this.fen = fen;\r\n        this.lastMove = lastMove;\r\n        this.previousPosition = previousPosition;\r\n        this.nextPosition = null;\r\n        this.comment = \"\";\r\n        this.sublines = [];\r\n\r\n        if(this.previousPosition){\r\n            if(this.lastMove.color === 'w'){\r\n                this.moveNumber = this.previousPosition.moveNumber + 1;\r\n            }else{\r\n                this.moveNumber = this.previousPosition.moveNumber\r\n            }\r\n        }else{\r\n            this.moveNumber = 0\r\n        }\r\n    }\r\n\r\n    sideToMove() {\r\n        if(!this.lastMove || this.lastMove.color === Constants.BLACK)\r\n            return Constants.WHITE\r\n        else\r\n            return Constants.BLACK\r\n    }\r\n\r\n    addNextPosition(nextPosition){\r\n        if(!this.nextPosition){\r\n            this.nextPosition = nextPosition;\r\n            return\r\n        }\r\n        if(this.nextPosition.fen === nextPosition.fen){\r\n            return\r\n        }\r\n        if(!this.sublines.find(pos => pos.fen === nextPosition.fen)){\r\n            this.sublines.push(nextPosition)\r\n        }\r\n    }\r\n}\r\n","import Position from './Position'\r\n\r\nconst STARTING_FEN = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1'\r\nexport default class{\r\n    constructor(){\r\n        this.positions = [];\r\n        this.startingPosition = new Position(STARTING_FEN);\r\n        this.whiteName = \"white\"\r\n        this.blackName = \"black\"\r\n    }\r\n}"],"sourceRoot":""}